<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title> Malla Curricular Auditor铆a UV 别</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0; padding: 20px;
      background-color: #e6d9f7;
      background-image: url('https://www.transparenttextures.com/patterns/cubes.png');
      color: #333;
      overflow-x: auto;
      user-select: none;
    }
    h1 {
      text-align: center;
      color: #6a0dad;
      font-weight: 700;
      font-size: 2.5rem;
      margin-bottom: 1.5rem;
      user-select: text;
    }
    .container {
      display: flex;
      gap: 1.4rem;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding-bottom: 20px;
    }
    .semester {
      background: #fff0f6;
      border-radius: 15px;
      box-shadow: 0 5px 12px rgba(106, 13, 173, 0.2);
      min-width: 260px;
      padding: 1rem 1.2rem;
      flex-shrink: 0;
      border: 2px solid transparent;
      transition: border-color 0.3s ease;
    }
    .semester:nth-child(2) {
      background: #d9f2e6;
      box-shadow: 0 5px 12px rgba(143, 199, 123, 0.3);
    }
    .semester:nth-child(3) {
      background: #d6e7fa;
      box-shadow: 0 5px 12px rgba(161, 207, 255, 0.3);
    }
    .semester:nth-child(4) {
      background: #f7e5fc;
      box-shadow: 0 5px 12px rgba(215, 187, 251, 0.3);
    }
    .semester:nth-child(5) { background: #fff0f6; box-shadow: 0 5px 12px rgba(106, 13, 173, 0.2);}
    .semester:nth-child(6) { background: #d9f2e6; box-shadow: 0 5px 12px rgba(143, 199, 123, 0.3);}
    .semester:nth-child(7) { background: #d6e7fa; box-shadow: 0 5px 12px rgba(161, 207, 255, 0.3);}
    .semester:nth-child(8) { background: #f7e5fc; box-shadow: 0 5px 12px rgba(215, 187, 251, 0.3);}
    .semester:nth-child(9) { background: #fff0f6; box-shadow: 0 5px 12px rgba(106, 13, 173, 0.2);}
    .semester:nth-child(10){ background: #d9f2e6; box-shadow: 0 5px 12px rgba(143, 199, 123, 0.3);}

    .semester h2 {
      text-align: center;
      margin-bottom: 1rem;
      color: #6a0dad;
      font-weight: 700;
      font-size: 1.3rem;
      user-select: text;
    }
    .course {
      background: #fff;
      border-radius: 12px;
      margin-bottom: 0.8rem;
      padding: 0.6rem 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 7px rgba(0,0,0,0.05);
      transition: background-color 0.3s ease, color 0.3s ease;
      cursor: pointer;
      user-select: none;
    }
    .course.locked {
      background: #e1dff4;
      color: #9c9c9c;
      cursor: not-allowed;
      pointer-events: none;
      box-shadow: none;
    }
    .course input[type="number"] {
      width: 50px;
      padding: 3px 6px;
      font-size: 1rem;
      border-radius: 8px;
      border: 1.5px solid #ccc;
      transition: border-color 0.3s ease;
      user-select: text;
    }
    .course input[type="number"]:focus {
      outline: none;
      border-color: #6a0dad;
      box-shadow: 0 0 5px #6a0dadaa;
    }
    .course.approved {
      background-color: #c8e6c9;
      border: 2px solid #4caf50;
      color: #2e7d32;
    }
    .course.exam {
      background-color: #fff9c4;
      border: 2px solid #fbc02d;
      color: #a77b00;
    }
    .course.reprobado {
      background-color: #ffcdd2;
      border: 2px solid #e53935;
      color: #b71c1c;
    }
    .course span.icon {
      margin-right: 8px;
      font-size: 1.15rem;
      user-select: none;
    }
    .course:not(.locked):hover {
      background-color: #dcd3f9;
    }
  </style>
</head>
<body>
  <h1> Malla Curricular Auditor铆a UV 别</h1>
  <div class="container" id="mallaContainer"></div>

  <script>
    const malla = {
      '1er Semestre': [
        { nombre: 'Introducci贸n a la contabilidad', abre: ['Contabilidad financiera'] },
        { nombre: 'Normativa empresarial I', abre: ['Normativa empresarial II'] },
        { nombre: 'Gesti贸n de organizaciones I', abre: ['Gesti贸n de organizaciones II'] },
        { nombre: 'Lengua materna y autorregulaci贸n' },
        { nombre: 'Matem谩ticas I', abre: ['Matem谩ticas II', 'Econom铆a I'] }
      ],
      '2do Semestre': [
        { nombre: 'Contabilidad financiera', requiere: ['Introducci贸n a la contabilidad'], abre: ['Normativa contable IFRS'] },
        { nombre: 'Normativa empresarial II', requiere: ['Normativa empresarial I'], abre: ['Normativa tributaria'] },
        { nombre: 'Gesti贸n de organizaciones II', requiere: ['Gesti贸n de organizaciones I'], abre: ['Gesti贸n de capital humano', 'Gesti贸n comercial'] },
        { nombre: 'Introducci贸n a la auditor铆a', abre: ['Control interno y gesti贸n de riesgos'] },
        { nombre: 'Econom铆a I', requiere: ['Matem谩ticas I'], abre: ['Econom铆a II', 'Costos para la toma de decisiones I'] },
        { nombre: 'Matem谩ticas II', requiere: ['Matem谩ticas I'], abre: ['Estad铆stica'] }
      ],
      '3er Semestre': [
        { nombre: 'Normativa contable IFRS', requiere: ['Contabilidad financiera'], abre: ['Normativa contable NIC SP', 'Taller de integraci贸n perfil UV I', 'Contabilidad avanzada I', 'Proyecto de investigaci贸n'] },
        { nombre: 'Normativa tributaria', requiere: ['Normativa empresarial II'], abre: ['Impuestos I', 'Taller de integraci贸n perfil UV I'] },
        { nombre: 'TIC para los negocios', abre: ['Taller de integraci贸n perfil UV I'] },
        { nombre: 'Econom铆a II', requiere: ['Econom铆a I'], abre: ['Taller de integraci贸n perfil UV I'] },
        { nombre: 'Estad铆stica', requiere: ['Matem谩ticas II'], abre: ['Estad铆stica para los negocios', 'Taller de integraci贸n perfil UV I'] },
        { nombre: 'Control interno y gesti贸n de riesgos', requiere: ['Introducci贸n a la auditor铆a'], abre: ['Fundamentos de auditor铆a', 'Ejecuci贸n de proyectos de auditor铆a', 'Auditor铆a de sistemas', 'Proyecto de investigaci贸n', 'Pr谩ctica temprana'] }
      ],
      '4to Semestre': [
        { nombre: 'Fundamentos de auditor铆a', requiere: ['Control interno y gesti贸n de riesgos'], abre: ['Taller de integraci贸n perfil UV I'] },
        { nombre: 'Normativa contable NIC SP', requiere: ['Normativa contable IFRS'], abre: ['Pr谩ctica temprana'] },
        { nombre: 'Impuestos I', requiere: ['Normativa tributaria'], abre: ['Tributaci贸n aplicada I', 'Pr谩ctica temprana'] },
        { nombre: 'Costos para la toma de decisiones I', requiere: ['Econom铆a I'], abre: ['Pr谩ctica temprana'] },
        { nombre: 'Estad铆stica para los negocios', requiere: ['Estad铆stica'], abre: ['Bases y aplicaci贸n de ciencias de datos', 'Costos para la toma de decisiones II'] },
        { nombre: 'Ingl茅s I', abre: ['Ingl茅s II'] }
      ],
      '5to Semestre': [
        { nombre: 'Bases y aplicaci贸n de ciencias de datos', requiere: ['Estad铆stica para los negocios'], abre: ['Ejecuci贸n de proyectos de auditor铆a'] },
        { nombre: 'Tributaci贸n aplicada I', requiere: ['Impuestos I'], abre: ['Impuestos II'] },
        { nombre: 'Gesti贸n de capital humano', requiere: ['Gesti贸n de organizaciones II'] },
        { nombre: 'Costos para la toma de decisiones II', requiere: ['Estad铆stica para los negocios'], abre: ['Introducci贸n a las finanzas', 'Gesti贸n de operaciones'] },
        { nombre: 'Ingl茅s II', requiere: ['Ingl茅s I'], abre: ['Ingl茅s III'] },
        { nombre: 'Taller de integraci贸n perfil UV I', requiere: ['Normativa contable IFRS', 'Normativa tributaria', 'TIC para los negocios', 'Econom铆a II', 'Estad铆stica', 'Fundamentos de auditor铆a'], abre: ['Taller de integraci贸n perfil UV II'] }
      ],
      '6to Semestre': [
        { nombre: 'Contabilidad avanzada I', requiere: ['Normativa contable IFRS'], abre: ['Contabilidad avanzada II'] },
        { nombre: 'Impuestos II', requiere: ['Tributaci贸n aplicada I'], abre: ['Tributaci贸n aplicada II', 'Proyecto de investigaci贸n'] },
        { nombre: 'Gesti贸n comercial', requiere: ['Gesti贸n de organizaciones II'], abre: ['Gesti贸n de operaciones'] },
        { nombre: 'Introducci贸n a las finanzas', requiere: ['Costos para la toma de decisiones II'], abre: ['Finanzas corporativas', 'Proyecto de investigaci贸n', 'Gesti贸n financiera'] },
        { nombre: 'Ingl茅s III', requiere: ['Ingl茅s II'], abre: ['Ingl茅s IV'] },
        { nombre: 'Taller de integraci贸n perfil UV II', requiere: ['Taller de integraci贸n perfil UV I'] },
        { nombre: 'Ejecuci贸n de proyectos de auditor铆a', requiere: ['Bases y aplicaci贸n de ciencias de datos', 'Control interno y gesti贸n de riesgos'] }
      ],
      '7mo Semestre': [
        { nombre: 'Contabilidad avanzada II', requiere: ['Contabilidad avanzada I'], abre: ['Contabilidad avanzada III', 'Auditor铆a de estados financieros', 'Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial', 'Pr谩ctica profesional'] },
        { nombre: 'Tributaci贸n aplicada II', requiere: ['Impuestos II'], abre: ['Gesti贸n tributaria', 'Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial', 'Pr谩ctica profesional'] },
        { nombre: 'Gesti贸n de operaciones', requiere: ['Gesti贸n comercial', 'Costos para la toma de decisiones II'], abre: ['Planificaci贸n y control de gesti贸n', 'Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial'] },
        { nombre: 'Auditor铆a de sistemas', requiere: ['Control interno y gesti贸n de riesgos'], abre: ['Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial'] },
        { nombre: 'Finanzas corporativas', requiere: ['Introducci贸n a las finanzas'], abre: ['Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Formulaci贸n y evaluaci贸n de proyectos de inversi贸n', 'Direcci贸n gerencial'] },
        { nombre: 'Ingl茅s IV', requiere: ['Ingl茅s III'], abre: ['Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial'] },
        { nombre: 'Proyecto de investigaci贸n', requiere: ['Normativa contable IFRS', 'Control interno y gesti贸n de riesgos', 'Impuestos II', 'Introducci贸n a las finanzas'], abre: ['Investigaci贸n aplicada', 'Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial'] },
        { nombre: 'Pr谩ctica temprana', requiere: ['Normativa contable NIC SP', 'Impuestos I', 'Costos para la toma de decisiones I', 'Control interno y gesti贸n de riesgos'], abre: ['Electivo 1 profesional', 'Electivo 2 profesional', 'Electivo 3 profesional', 'Direcci贸n gerencial', 'Pr谩ctica profesional'] }
      ],
      '8vo Semestre': [
        { nombre: 'Contabilidad avanzada III', requiere: ['Contabilidad avanzada II'], abre: ['Taller de integraci贸n profesional'] },
        { nombre: 'Gesti贸n tributaria', requiere: ['Tributaci贸n aplicada II'], abre: ['Taller de integraci贸n profesional'] },
        { nombre: 'Planificaci贸n y control de gesti贸n', requiere: ['Gesti贸n de operaciones'], abre: ['Taller de integraci贸n profesional'] },
        { nombre: 'Auditor铆a de estados financieros', requiere: ['Contabilidad avanzada II'], abre: ['Pr谩ctica profesional', 'Taller de integraci贸n profesional'] },
        { nombre: 'Gesti贸n financiera', requiere: ['Introducci贸n a las finanzas'], abre: ['Taller de integraci贸n profesional'] },
        { nombre: 'Investigaci贸n aplicada', requiere: ['Proyecto de investigaci贸n'], abre: ['Taller de integraci贸n profesional'] }
      ],
      '9no Semestre': [
        { nombre: 'Electivo 1 profesional' },
        { nombre: 'Electivo 2 profesional' },
        { nombre: 'Electivo 3 profesional' },
        { nombre: 'Formulaci贸n y evaluaci贸n de proyectos de inversi贸n', requiere: ['Finanzas corporativas'] },
        { nombre: 'Direcci贸n gerencial' },
        { nombre: 'Pr谩ctica profesional' }
      ],
      '10mo Semestre': [
        { nombre: 'Taller de integraci贸n profesional' }
      ]
    };

    // Carga o inicia notas vac铆as
    let notas = JSON.parse(localStorage.getItem('notas')) || {};

    const container = document.getElementById('mallaContainer');

    function evaluarEstado(nota) {
      if (nota === '' || nota == null) return '';
      if (nota < 4.0) return 'reprobado';
      if (nota >= 5.0) return 'approved';
      return 'exam';
    }

    function puedeDesbloquear(curso) {
      if (!curso.requiere) return true;
      for (const req of curso.requiere) {
        const notaReq = notas[req];
        if (notaReq === undefined || notaReq < 4.0) return false;
      }
      return true;
    }

    function crearCurso(curso) {
      const div = document.createElement('div');
      div.classList.add('course');
      div.dataset.nombre = curso.nombre;

      const icon = document.createElement('span');
      icon.className = 'icon';
      icon.textContent = '';
      div.appendChild(icon);

      const texto = document.createElement('span');
      texto.textContent = curso.nombre;
      div.appendChild(texto);

      const input = document.createElement('input');
      input.type = 'number';
      input.min = 1;
      input.max = 7;
      input.step = 0.1;
      input.value = notas[curso.nombre] || '';
      input.title = 'Ingrese nota (1.0 a 7.0)';
      div.appendChild(input);

      input.addEventListener('input', () => {
        const val = parseFloat(input.value);
        if (!isNaN(val)) {
          notas[curso.nombre] = val;
        } else {
          delete notas[curso.nombre];
        }
        localStorage.setItem('notas', JSON.stringify(notas));
        actualizarEstado();
      });

      return div;
    }

    function actualizarEstado() {
      container.querySelectorAll('.course').forEach(c => {
        c.classList.remove('approved', 'exam', 'reprobado', 'locked');
        const nombre = c.dataset.nombre;
        const nota = notas[nombre];
        const estado = evaluarEstado(nota);
        if (estado) c.classList.add(estado);

        // Bloquear si no cumple requisitos o est谩 reprobado o sin nota en prereqs
        const curso = buscarCursoPorNombre(nombre);
        if (!puedeDesbloquear(curso) || estado === 'reprobado' || nota === undefined) {
          c.classList.add('locked');
          c.querySelector('input').disabled = true;
        } else {
          c.querySelector('input').disabled = false;
        }
      });
    }

    // Busca el curso en la malla para un nombre dado
    function buscarCursoPorNombre(nombre) {
      for (const semestre in malla) {
        for (const curso of malla[semestre]) {
          if (curso.nombre === nombre) return curso;
        }
      }
      return null;
    }

    // Renderizar la malla completa
    function renderizarMalla() {
      container.innerHTML = '';
      for (const semestre in malla) {
        const divSem = document.createElement('div');
        divSem.classList.add('semester');
        const h2 = document.createElement('h2');
        h2.textContent = semestre;
        divSem.appendChild(h2);

        for (const curso of malla[semestre]) {
          const cursoDiv = crearCurso(curso);
          divSem.appendChild(cursoDiv);
        }
        container.appendChild(divSem);
      }
      actualizarEstado();
    }

    renderizarMalla();
  </script>
</body>
</html>
